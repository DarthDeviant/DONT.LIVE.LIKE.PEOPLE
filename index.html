<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>DONT.LIVE.LIKE.PEOPLE</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      background: #000;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      overflow: hidden;
      height: 100vh;
      width: 100vw;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    canvas {
      width: 100vw;
      height: 100vh;
      display: block;
      filter: blur(2px) drop-shadow(0 0 15px rgba(255, 182, 193, 0.6))
                    drop-shadow(0 0 25px rgba(0, 0, 139, 0.6));
      position: absolute;
      top: 0;
      left: 0;
    }

    .player-controls {
      position: absolute;
      bottom: 24px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(8px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 50px;
      padding: 12px 24px;
      display: flex;
      align-items: center;
      gap: 16px;
      min-width: 400px;
      z-index: 10;
    }

    .play-button {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.1);
      border: none;
      color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
    }
    .play-button:hover { background: rgba(255, 255, 255, 0.2); }

    .time-controls {
      flex: 1;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .time-display {
      font-size: 12px;
      color: rgba(255, 255, 255, 0.6);
      font-family: monospace;
      min-width: 40px;
    }

    .progress-slider {
      flex: 1;
      height: 4px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 2px;
      position: relative;
      cursor: pointer;
    }

    .progress-fill {
      height: 100%;
      background: white;
      border-radius: 2px;
      width: 0%;
      transition: width 0.1s;
    }

    .volume-controls {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .volume-button {
      width: 24px;
      height: 24px;
      border: none;
      background: transparent;
      color: rgba(255, 255, 255, 0.6);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .volume-button:hover { color: white; }

    .volume-slider {
      width: 64px;
      height: 4px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 2px;
      position: relative;
      cursor: pointer;
    }

    .volume-fill {
      height: 100%;
      background: white;
      border-radius: 2px;
      width: 70%;
    }
  </style>
</head>
<body>
  <canvas id="canvas"></canvas>
  <audio id="audio" preload="auto" crossorigin="anonymous" src="DLLP2.mp3"></audio>

  <div class="player-controls">
    <button class="play-button" id="playButton">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
        <path d="M8 5v14l11-7z"/>
      </svg>
    </button>

    <div class="time-controls">
      <span class="time-display" id="currentTime">0:00</span>
      <div class="progress-slider" id="progressSlider">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <span class="time-display" id="duration">0:00</span>
    </div>

    <div class="volume-controls">
      <button class="volume-button" id="volumeButton">
        <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
          <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3
                   c0-1.77-1.02-3.29-2.5-4.03v8.05
                   c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06
                   c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71
                   v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
        </svg>
      </button>
      <div class="volume-slider" id="volumeSlider">
        <div class="volume-fill" id="volumeFill"></div>
      </div>
    </div>
  </div>

  <script>
    class MusicVisualizer {
      constructor() {
        this.audio = document.getElementById('audio');
        this.canvas = document.getElementById('canvas');
        this.ctx = this.canvas.getContext('2d');
        this.playButton = document.getElementById('playButton');
        this.currentTimeEl = document.getElementById('currentTime');
        this.durationEl = document.getElementById('duration');
        this.progressSlider = document.getElementById('progressSlider');
        this.progressFill = document.getElementById('progressFill');
        this.volumeButton = document.getElementById('volumeButton');
        this.volumeSlider = document.getElementById('volumeSlider');
        this.volumeFill = document.getElementById('volumeFill');

        this.isPlaying = false;
        this.currentTime = 0;
        this.duration = 0;
        this.volume = 0.7;
        this.isMuted = false;

        this.audioContext = null;
        this.analyser = null;
        this.source = null;
        this.animationId = null;

        this.mandalaRotation = 0;
        this.showMandala = false;
        this.transitionProgress = 0;

        this.init();
      }

      init() {
        this.setupCanvas();
        this.setupEventListeners();
        setInterval(() => { this.showMandala = Math.random() > 0.7; }, 5000);
      }

      setupCanvas() {
        const resize = () => {
          this.canvas.width = window.innerWidth;
          this.canvas.height = window.innerHeight;
        };
        resize();
        window.addEventListener('resize', resize);
      }

      setupEventListeners() {
        this.playButton.addEventListener('click', () => this.togglePlay());

        this.audio.addEventListener('timeupdate', () => {
          this.currentTime = this.audio.currentTime;
          this.updateTimeDisplay();
        });

        this.audio.addEventListener('loadedmetadata', () => {
          this.duration = this.audio.duration;
          this.updateTimeDisplay();
        });

        this.audio.addEventListener('ended', () => {
          this.isPlaying = false;
          this.updatePlayButton();
        });

        this.progressSlider.addEventListener('click', (e) => {
          const rect = this.progressSlider.getBoundingClientRect();
          const percent = (e.clientX - rect.left) / rect.width;
          this.audio.currentTime = percent * this.duration;
        });

        this.volumeButton.addEventListener('click', () => this.toggleMute());

        this.volumeSlider.addEventListener('click', (e) => {
          const rect = this.volumeSlider.getBoundingClientRect();
          const percent = (e.clientX - rect.left) / rect.width;
          this.volume = percent;
          this.audio.volume = this.volume;
          this.updateVolumeDisplay();
        });

        this.audio.volume = this.volume;
      }

      async togglePlay() {
        if (this.isPlaying) {
          this.audio.pause();
          this.isPlaying = false;
          cancelAnimationFrame(this.animationId);
        } else {
          if (!this.audioContext) await this.initializeAudioContext();
          this.audio.play();
          this.isPlaying = true;
          this.startVisualization();
        }
        this.updatePlayButton();
      }

      async initializeAudioContext() {
        this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
        this.analyser = this.audioContext.createAnalyser();
        this.analyser.fftSize = 256;
        this.source = this.audioContext.createMediaElementSource(this.audio);
        this.source.connect(this.analyser);
        this.analyser.connect(this.audioContext.destination);
      }

      startVisualization() {
        const bufferLength = this.analyser.frequencyBinCount;
        const dataArray = new Uint8Array(bufferLength);

        const draw = () => {
          if (!this.isPlaying) return;
          this.analyser.getByteFrequencyData(dataArray);

          this.ctx.fillStyle = '#000';
          this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);

          // Transition logic
          if (this.showMandala && this.transitionProgress < 1) {
            this.transitionProgress += 0.02;
          } else if (!this.showMandala && this.transitionProgress > 0) {
            this.transitionProgress -= 0.02;
          }
          this.transitionProgress = Math.max(0, Math.min(1, this.transitionProgress));

          this.drawBars(dataArray, 1 - this.transitionProgress);
          this.drawMandala(100, dataArray, this.transitionProgress);

          this.animationId = requestAnimationFrame(draw);
        };
        draw();
      }

      getGradient() {
        const grad = this.ctx.createLinearGradient(0, 0, 0, this.canvas.height);
        grad.addColorStop(0, 'darkblue');
        grad.addColorStop(1, 'lightpink');
        return grad;
      }

      drawBars(data, alpha=1) {
        this.ctx.globalAlpha = alpha;
        const barWidth = (this.canvas.width / data.length) * 2.5;
        let x = 0;
        for (let i = 0; i < data.length; i++) {
          const barHeight = data[i];
          this.ctx.fillStyle = this.getGradient();
          this.ctx.fillRect(x, this.canvas.height - barHeight, barWidth, barHeight);
          x += barWidth + 1;
        }
      }

      drawMandala(radius, data, alpha=1) {
        this.ctx.save();
        this.ctx.translate(this.canvas.width / 2, this.canvas.height / 2);
        this.ctx.rotate(this.mandalaRotation);
        this.ctx.globalAlpha = alpha;
        this.ctx.strokeStyle = this.getGradient();
        this.ctx.lineWidth = 2;

        const sides = 12;
        for (let i = 0; i < sides; i++) {
          this.ctx.rotate((Math.PI * 2) / sides);
          this.ctx.beginPath();
          for (let j = 0; j < data.length; j++) {
            const r = radius + data[j] / 2;
            const angle = (j / data.length) * Math.PI * 2;
            const x = Math.cos(angle) * r;
            const y = Math.sin(angle) * r;
            if (j === 0) this.ctx.moveTo(x, y);
            else this.ctx.lineTo(x, y);
          }
          this.ctx.closePath();
          this.ctx.stroke();
        }
        this.ctx.restore();
        this.mandalaRotation += 0.002;
      }

      updatePlayButton() {
        this.playButton.innerHTML = this.isPlaying ?
          '<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>' :
          '<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z"/></svg>';
      }

      updateTimeDisplay() {
        this.currentTimeEl.textContent = this.formatTime(this.currentTime);
        this.durationEl.textContent = this.formatTime(this.duration);
        if (this.duration > 0) {
          const percent = (this.currentTime / this.duration) * 100;
          this.progressFill.style.width = percent + '%';
        }
      }

      updateVolumeDisplay() {
        const percent = this.volume * 100;
        this.volumeFill.style.width = percent + '%';
      }

      toggleMute() {
        this.isMuted = !this.isMuted;
        this.audio.volume = this.isMuted ? 0 : this.volume;
      }

      formatTime(time) {
        const minutes = Math.floor(time / 60);
        const seconds = Math.floor(time % 60);
        return `${minutes}:${seconds.toString().padStart(2, '0')}`;
      }
    }

    document.addEventListener('DOMContentLoaded', () => new MusicVisualizer());
  </script>
</body>
</html>
